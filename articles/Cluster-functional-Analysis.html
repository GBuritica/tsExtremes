<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tsExtremes">
<title>Section 2: Cluster inference • tsExtremes</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Section 2: Cluster inference">
<meta property="og:description" content="tsExtremes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=%7BG-03X4DCM0HF%7D"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '{G-03X4DCM0HF}');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tsExtremes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/tsExtremes.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Cluster-functional-Analysis.html">Section 2: Cluster inference</a>
    <a class="dropdown-item" href="../articles/Example-Analysis.html">Section 1: Tail-index inference</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/GBuritica/tsExtremes/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Section 2: Cluster inference</h1>
                        <h4 data-toc-skip class="author">Gloria
Buriticá</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/GBuritica/tsExtremes/blob/HEAD/vignettes/articles/Cluster-functional-Analysis.Rmd" class="external-link"><code>vignettes/articles/Cluster-functional-Analysis.Rmd</code></a></small>
      <div class="d-none name"><code>Cluster-functional-Analysis.Rmd</code></div>
    </div>

    
    
<style>
p.comment{
background-color: #E3E7F1;
padding: 10px;
border: 1px solid black;
margin-left: 25px;
border-radius: 5px;
font-style: italic;
}

</style>
<div class="section level3">
<h3 id="main-goals-of-this-tutorial">Main goals of this tutorial<a class="anchor" aria-label="anchor" href="#main-goals-of-this-tutorial"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Review heavy-tailed time series variables.</li>
<li>Review the extremal index and cluster statistics.</li>
<li>Compute estimates of cluster statistics.</li>
</ol>
<p>Previously you learnt how to estimate the tail-index of a regularly
varying random variable <span class="math inline">\(X\)</span>, which
quantifies the magnitude of extremes. In this section we consider
heavy-tailed time series <span class="math inline">\((X_t)\)</span>
taking values in <span class="math inline">\(\mathbb{R}^d\)</span>, and
we focus on studying the dependence structure of extremes. The main
question that we would like to answer is how one extreme record can
trigger future heavy records.</p>
</div>
<div class="section level3">
<h3 id="heavy-tailed-time-series">Heavy-tailed time series<a class="anchor" aria-label="anchor" href="#heavy-tailed-time-series"></a>
</h3>
<div class="section level4">
<h4 id="regularly-varying-time-series">Regularly varying time series<a class="anchor" aria-label="anchor" href="#regularly-varying-time-series"></a>
</h4>
<p>We now consider an <span class="math inline">\(\mathbb{R}^d\)</span>-valued time series <span class="math inline">\((X_t)\)</span> and we characterize next
heavy-tailed series by means of the notion of multivariate regular
variation. <br><br></p>
<p class="comment">
<strong>Definition.</strong> (Regular variation) We say that an <span class="math inline">\(\mathbb{R}^d\)</span>-valued stationary series
<span class="math inline">\((X_t)\)</span> is regularly varying with
<strong>tail-index</strong> <span class="math inline">\(\alpha &gt;
0\)</span> if for all <span class="math inline">\(h &gt; 0\)</span>, the
vector <span class="math inline">\((X_0,X_1,\dots,X_h)\)</span>
satisfies multivariate regular variation: there exists <span class="math inline">\((\Theta_t)\)</span> such that, for <span class="math inline">\(y &gt; 1\)</span>, <span class="math display">\[
\mathbb{P}( x^{-1}|X_0| &gt; y,  |X_0|^{-1}(X_t)_{t=-h,\dots,h} \in
\cdot \mid |X_0| &gt; x  ) \to
y^{-\alpha}\mathbb{P}((\Theta_t)_{t=-h,\dots,h} \in \cdot ),
\]</span> as <span class="math inline">\(x \to \infty\)</span>, and
<span class="math inline">\(|\Theta_0| = 1\)</span>. The process <span class="math inline">\((\Theta_t)\)</span> is called the
<strong>spectral-tail</strong> process of the series.
</p>
<p>
</p>
<p>The spectral-tail process plays an important role in the
understanding of the space and time dependencies of the extremes of the
series. It measures the impact of one extreme record at time zero on the
future behavior of the series over finite windows of time.</p>
<p><strong>Auto-regressive heavy-tailed time series</strong></p>
<p>One first example of a regularly varying time series are ARMA
processes with heavy-tailed innovations. Consider <span class="math inline">\((Z_t)\)</span> a sequence of iid innovations
admitting a regularly varying distribution with tail index <span class="math inline">\(\alpha &gt; 0\)</span>. <span class="math display">\[
X_t = \varphi X_{t-1} + Z_t
\]</span></p>
<p>Moreover, we see next that many common time series lie within the
framework of heavy-tailed time series.</p>
<p><strong>Further examples of heavy-tailed time series</strong> include
linear filters with regularly varying innovations, and also GARCH
models. These examples are discussed in all generality in <span class="citation">(Kulik and Soulier 2020)</span>.</p>
</div>
<div class="section level4">
<h4 id="weak-extremal-temporal-dependence">Weak extremal temporal dependence<a class="anchor" aria-label="anchor" href="#weak-extremal-temporal-dependence"></a>
</h4>
<p>It is common that the impact of one extreme record at time zero
decays over time. In this case, we are in the setting of weak extremal
temporal dependence.</p>
</div>
</div>
<div class="section level3">
<h3 id="extremal-index">Extremal index<a class="anchor" aria-label="anchor" href="#extremal-index"></a>
</h3>
<p>The extremal index of a stationary time series was motivated by the
findings in (Newell, 1964), (Leadbetter, 1983), and (Leadbetter <em>et
al.</em>, 1983), who discovered that for numerous real-valued stationary
sequences <span class="math inline">\((X_t)\)</span>, <span class="math display">\[
Pr \left( \max_{t=1,\dots,n} |X_t| \le u_n \right) \; \approx \; \Big[
Pr( X_1 \le u_n) \Big]^{n \theta_X} \; = \; Pr \left( \max_{t=1,\dots,n}
|X^\prime_t| \le u_n \right)^{\theta_X}, \quad n \to \infty,
\]</span> where <span class="math inline">\((X^\prime_t)\)</span> is a
time series of iid variables distributed as <span class="math inline">\(X_1\)</span>, <span class="math inline">\(\theta_{X} \in [0,1]\)</span>, and <span class="math inline">\(u_n = u_n(\tau)\)</span> is a sequence of high
thresholds such that <span class="math inline">\(n \, Pr(X_1 &gt; u_n)
\to \tau\)</span>, and the previous relation holds for every <span class="math inline">\(\tau &gt; 0\)</span>. If such a constant <span class="math inline">\(\theta_{X}\)</span> exists, we say that the time
series admits an <strong>extremal index</strong> given by <span class="math inline">\(\theta_X\)</span>.</p>
<p>From the expression above, we see that the extremal index measures
the shrinkage effect of the blocks of maxima compared to its behaviour
in the iid setting. The reason for this shrinkage is that extremes
records of numerous time series tend to cluster, and high records are
likely to be followed by a period with several extreme values. To see
how these time dependencies perturb the behavior of the series, consider
the partition of the sample into <span class="math inline">\(m_n =
\lfloor n/b_n \rfloor\)</span> disjoint blocks <span class="math display">\[
\underbrace{X_1,\dots,X_{b_n}}_{\mathcal{B}_1},  \underbrace{X_{b_n+1},\dots,X_{2
b_n}}_{\mathcal{B}_2}, \dots, \underbrace{X_{m_nb_n - b_n
+1},\dots,X_{m_n b_n}}_{\mathcal{B}_{m_n}},
\]</span> Considering the maxima over each block consists in keeping the
largest records and discarding the rest of the observations. However,
when extremes cluster in short periods, these procedure will discard
several high recordings. How many high records we loose by doing so, is
measured by the extremal index. More precisely, the extremal index has
an interpretation as be seen as the reciprocal of the number of high
recordings in a block.</p>
<div class="section level4">
<h4 id="inference-of-the-extremal-index">Inference of the extremal index<a class="anchor" aria-label="anchor" href="#inference-of-the-extremal-index"></a>
</h4>
<p>The extremal index is essential to correct inference procedures in
extreme value statistics initially tailored for iid observations. For
example, it can be used to extrapolate high quantiles from the sample´s
blocks of maxima. In the following, we will see how to infer the
extremal index from sample observations. For this purpose, let <span class="math inline">\({\bf X}_1,\dots, {\bf X}_n\)</span> be
observations with values in <span class="math inline">\(\mathbb{R}^d\)</span> from a stationary time
series <span class="math inline">\(({\bf
X}_t)_{t\in\mathbb{Z}}\)</span>. We focus on the case of heavy-tailed
series admitting a tail-index <span class="math inline">\(\alpha &gt;
0\)</span>. In this setting, (Buriticá <em>et al.</em>, 2021) introduced
the extremal index cluster estimator given by</p>
<p class="comment">
<strong>Spectral cluster estimator</strong> of the extremal index: <span class="math display">\[
\widehat \theta_{|{\bf X}|} = \frac{1}{k_n}   \sum_{t=1}^{m_n}
\frac{\|\mathcal{B}_t\|^{\widehat\alpha}_\infty}{\|\mathcal{B}_t\|^{\widehat\alpha}_{\widehat\alpha}}1(\|\mathcal{B}_t\|_{\widehat\alpha}\ge
\|\mathcal{B}_t\|_{\widehat\alpha,(k)}),
\]</span> where <span class="math inline">\(\|\mathcal{B}_t\|_{\widehat\alpha,(1)} \ge
\|\mathcal{B}_t\|_{\widehat\alpha,(2)} \ge \cdots \ge
\|\mathcal{B}_t\|_{\widehat\alpha,(m_n)}\)</span> are order statistics
of the <span class="math inline">\(\widehat\alpha-\)</span>norms of
blocks, and <span class="math inline">\(\widehat \alpha\)</span> is an
estimate for the tail index <span class="math inline">\(\alpha &gt;
0\)</span>.
</p>
<p>The sequence <span class="math inline">\((k_n)\)</span> is a tuning
parameter of the spectral cluster estimator. It must be chose to be a
small proportion of the total amount of blocks <span class="math inline">\(m_n = \lfloor n/b_n \rfloor\)</span>, such that
<span class="math inline">\(m_n/k_n \to \infty\)</span>. In this way,
inference is based solely on the extremal blocks.</p>
</div>
</div>
<div class="section level3">
<h3 id="implementation">Implementation<a class="anchor" aria-label="anchor" href="#implementation"></a>
</h3>
<p>We start by loading the <span class="math inline">\(\texttt{tsExtremes}\)</span> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/GBuritica/tsExtremes" class="external-link">tsExtremes</a></span><span class="op">)</span></span></code></pre></div>
<p>To implement the spectral cluster estimator, we first start by
computing and estimate of the tail-index of the series. For stationary
time series with short-range dependence, the Hill-type estimators still
yield good results in general. The <span class="math inline">\(\texttt{tsExtremes}\)</span> package also allows
to sample from classical time series models, and to estimate the cluster
lengths. The following chunk simulates from the solution to the
stochastic recurrence equation <span class="math display">\[
X_t = A_t X_{t-1} + B_t, \quad t \in \mathbb{Z},
\]</span> with <span class="math inline">\(\log A_t \sim N_t -
0.5\)</span>, <span class="math inline">\(B_t ~ Unif(0,1)\)</span>,
<span class="math inline">\(N_t \sim \mathcal{N}(0,1)\)</span> and <span class="math inline">\((A_t), (B_t)\)</span> are independent iid
sequences. In this case <span class="math inline">\(\alpha = 1\)</span>
and <span class="math inline">\(\theta_X \approx 0.2792\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">path</span>         <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ARCHm.html">ARCHm</a></span><span class="op">(</span><span class="fl">8000</span><span class="op">)</span></span>
<span><span class="va">alphae</span>       <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="../reference/alphaestimator.html">alphaestimator</a></span><span class="op">(</span><span class="va">path</span>,k1<span class="op">=</span><span class="fl">1200</span><span class="op">)</span><span class="op">$</span><span class="va">xi</span> </span>
<span><span class="va">theta</span>        <span class="op">&lt;-</span> <span class="fl">0.2792</span></span></code></pre></div>
<p>The functions piCP computes estimates of the extremal index, as well
as estimates of cluster lengths, as a function of k.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimate</span>     <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/piCP.html">piCP</a></span><span class="op">(</span><span class="va">path</span>,<span class="va">alphae</span><span class="op">)</span> </span>
<span><span class="va">ks</span>           <span class="op">&lt;-</span>  <span class="va">estimate</span><span class="op">$</span><span class="va">k</span></span></code></pre></div>
<p>Notice that this method also computes estimates for the asymptotic
variance relying on (Buriticá and Wintenberger, 2022), which we use to
draw the confidence intervals. The red line corresponds to the true
value.</p>
<p><img src="Cluster-functional-Analysis_files/figure-html/plot%20cluster-1.png" width="864" style="display: block; margin: auto;"></p>
<p>Similarly, we can produce this plots with the option plot=T. The
dashed line in blue gives the estimate for k = 10.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimate</span>     <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/piCP.html">piCP</a></span><span class="op">(</span><span class="va">path</span>,<span class="va">alphae</span>,plot<span class="op">=</span><span class="cn">T</span><span class="op">)</span> </span></code></pre></div>
<p><img src="Cluster-functional-Analysis_files/figure-html/plot%20cluster%202-1.png" width="864" style="display: block; margin: auto;"></p>
<p>Finally, recall the rainfall data set that we presented in the tail
index analysis. We can now apply our method to this data set.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path</span>         <span class="op">&lt;-</span> <span class="va">rainfall</span><span class="op">$</span><span class="va">BREST</span><span class="op">[</span><span class="va">rainfall</span><span class="op">$</span><span class="va">SEASON</span><span class="op">==</span><span class="st">"SPRING"</span><span class="op">]</span></span>
<span><span class="va">alphae</span>       <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="../reference/alphaestimator.html">alphaestimator</a></span><span class="op">(</span><span class="va">path</span>,k1<span class="op">=</span><span class="fl">150</span><span class="op">)</span><span class="op">$</span><span class="va">xi</span> </span>
<span><span class="va">estimate</span>     <span class="op">&lt;-</span> <span class="fu"><a href="../reference/piCP.html">piCP</a></span><span class="op">(</span><span class="va">path</span>,<span class="va">alphae</span>,plot<span class="op">=</span><span class="cn">T</span><span class="op">)</span> </span></code></pre></div>
<p><img src="Cluster-functional-Analysis_files/figure-html/rainfall%20cluster-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-kulik:soulier:2020" class="csl-entry">
Kulik, R., and P. Soulier. 2020. <em>Heavy-Tailed Time Series</em>.
Springer.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gloria Buriticá.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
