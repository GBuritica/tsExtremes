<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cluster inference • tsExtremes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Cluster inference">
<meta property="og:description" content="tsExtremes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tsExtremes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Cluster-functional-Analysis.html">Cluster inference</a>
    </li>
    <li>
      <a href="../articles/Example-Analysis.html">Tail index inference</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/GBuritica/tsExtremes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Cluster inference</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/GBuritica/tsExtremes/blob/HEAD/vignettes/articles/Cluster-functional-Analysis.Rmd" class="external-link"><code>vignettes/articles/Cluster-functional-Analysis.Rmd</code></a></small>
      <div class="hidden name"><code>Cluster-functional-Analysis.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/GBuritica/tsExtremes" class="external-link">tsExtremes</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="cluster-inference">Cluster inference<a class="anchor" aria-label="anchor" href="#cluster-inference"></a>
</h2>
<p>The tsExtremes allows to sample from classical time series models,
estimate the tail index of regular variation, and compute cluster
statistics. First, let’s start by simulations a time series and
computing its tail index.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path</span>         <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ARCHm.html">ARCHm</a></span><span class="op">(</span><span class="fl">20000</span><span class="op">)</span></span>
<span><span class="va">alphae</span>       <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="../reference/alphaestimator.html">alphaestimator</a></span><span class="op">(</span><span class="va">path</span>,k1<span class="op">=</span><span class="fl">1200</span><span class="op">)</span><span class="op">$</span><span class="va">xi</span> </span>
<span><span class="va">theta</span>        <span class="op">&lt;-</span> <span class="fl">0.2792</span></span></code></pre></div>
<p>With the values that we computed, we are now ready to infer classical
cluster statistics. For example, the extremal index of the series and
the cluster lengths. The functions piCP computes estimates for this
quantities as a function of k.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimate</span>     <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/piCP.html">piCP</a></span><span class="op">(</span><span class="va">path</span>,<span class="va">alphae</span><span class="op">)</span> </span>
<span><span class="va">ks</span>           <span class="op">&lt;-</span>  <span class="va">estimate</span><span class="op">$</span><span class="va">k</span></span></code></pre></div>
<p>Notice that this method also computes estimates for the asymptotic
variance which we can use to draw the confidence intervals. The red line
corresponds to the true value.</p>
<p><img src="Cluster-functional-Analysis_files/figure-html/plot%20cluster-1.png" width="864" style="display: block; margin: auto;">
Similarly, we can produce this plots with the option plot=T. The dashed
line in blue gives the estimate for k = 10.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimate</span>     <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/piCP.html">piCP</a></span><span class="op">(</span><span class="va">path</span>,<span class="va">alphae</span>,plot<span class="op">=</span><span class="cn">T</span><span class="op">)</span> </span></code></pre></div>
<p><img src="Cluster-functional-Analysis_files/figure-html/plot%20cluster%202-1.png" width="864" style="display: block; margin: auto;"></p>
<p>Finally, recall the rainfall data set that we presented in the tail
index analysis. We can now apply our method to this data set.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path</span>         <span class="op">&lt;-</span> <span class="va">rainfall</span><span class="op">$</span><span class="va">BREST</span><span class="op">[</span><span class="va">rainfall</span><span class="op">$</span><span class="va">SEASON</span><span class="op">==</span><span class="st">"SPRING"</span><span class="op">]</span></span>
<span><span class="va">alphae</span>       <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="../reference/alphaestimator.html">alphaestimator</a></span><span class="op">(</span><span class="va">path</span>,k1<span class="op">=</span><span class="fl">150</span><span class="op">)</span><span class="op">$</span><span class="va">xi</span> </span>
<span><span class="va">estimate</span>     <span class="op">&lt;-</span> <span class="fu"><a href="../reference/piCP.html">piCP</a></span><span class="op">(</span><span class="va">path</span>,<span class="va">alphae</span>,plot<span class="op">=</span><span class="cn">T</span><span class="op">)</span> </span></code></pre></div>
<p><img src="Cluster-functional-Analysis_files/figure-html/rainfall%20cluster-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Gloria Buriticá.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
