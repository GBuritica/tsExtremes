[{"path":"https://gburitica.github.io/tsExtremes/articles/Cluster-functional-Analysis.html","id":"main-goals-of-this-tutorial","dir":"Articles","previous_headings":"","what":"Main goals of this tutorial","title":"Section 2: Cluster inference","text":"Review heavy-tailed time series variables. Review extremal index cluster statistics. Compute estimates cluster statistics. Previously learnt estimate tail-index regularly varying random variable \\(X\\), quantifies magnitude extremes. section consider heavy-tailed time series \\((X_t)\\) taking values \\(\\mathbb{R}^d\\), focus studying dependence structure extremes. main question like answer one extreme record can trigger future heavy records.","code":""},{"path":"https://gburitica.github.io/tsExtremes/articles/Cluster-functional-Analysis.html","id":"regularly-varying-time-series","dir":"Articles","previous_headings":"","what":"Regularly varying time series","title":"Section 2: Cluster inference","text":"now consider \\(\\mathbb{R}^d\\)-valued time series \\((X_t)\\) characterize next heavy-tailed series means notion multivariate regular variation. Definition. (Regular variation) say \\(\\mathbb{R}^d\\)-valued stationary series \\((X_t)\\) regularly varying tail-index \\(\\alpha > 0\\) \\(h > 0\\), vector \\((X_0,X_1,\\dots,X_h)\\) satisfies multivariate regular variation: exists \\((\\Theta_t)\\) , \\(y > 1\\), \\[ \\mathbb{P}( x^{-1}|X_0| > y,  |X_0|^{-1}(X_t)_{t=-h,\\dots,h} \\\\cdot \\mid |X_0| > x  ) \\y^{-\\alpha}\\mathbb{P}((\\Theta_t)_{t=-h,\\dots,h} \\\\cdot ), \\] \\(x \\\\infty\\), \\(|\\Theta_0| = 1\\). process \\((\\Theta_t)\\) called spectral-tail process series.  spectral-tail process plays important role understanding space time dependencies extremes series. measures impact one extreme record time zero future behavior series finite windows time.","code":""},{"path":"https://gburitica.github.io/tsExtremes/articles/Cluster-functional-Analysis.html","id":"examples","dir":"Articles","previous_headings":"Regularly varying time series","what":"Examples","title":"Section 2: Cluster inference","text":"get first glimpse extremal dependencies series, extremogram introduced (Davis Mikosch 2009). defined sequence \\((\\chi_t)\\) \\[ \\chi_t = \\mathbb{P}( |X_t| > x \\mid |X_0| > x) = \\mathbb{E}[ 1\\land |\\Theta_t|^\\alpha ], \\qquad t > 0, \\] \\((\\Theta_t)\\) spectral-tail process sequence. One first example regularly varying time series ARMA processes heavy-tailed innovations. following code plots empirical extremogram sequence \\(AR(\\varphi)\\) model \\((X_t)\\) defined solution equation \\[ X_t = \\varphi X_{t-1} + Z_t\\,, \\quad t \\\\mathbb{R} \\] \\((Z_t)\\) iid regularly varying innovations tail-index \\(\\alpha > 0\\), \\(\\varphi \\[0,1)\\). comparison, also plot extremogram sequence \\((Z_t)\\).   plot dashed-line corresponds baseline behavior case extremal independence, corresponds case \\(|\\Theta_0| = 1\\) \\(|\\Theta_t| = 0\\) $t = 0 $. Indeed, case independent regularly varying time series. see, \\(\\phi = .5\\), extremogram \\(AR(\\phi)\\) model takes large values first lags, behavior similar one iid case. case $|_t| $, \\(t \\\\infty\\). framework weak extremal dependence common numerous time series. nutshell, models fact one large record time zero can’t impact future extremes indefinitely. Instead, models expect strength extremal dependence decays time. examples heavy-tailed time series short-range extremal dependence include linear filters regularly varying innovations, also GARCH models. examples discussed generality (Kulik Soulier 2020). actually natural many applications impact one extreme record time zero decays time. case, setting weak extremal temporal dependence \\(|\\Theta_t| \\0\\), \\(t \\\\infty\\). special cases extremes occur clusters finite length short windows time featuring several extremal recordings. case, -called extremal index can seen summary clustering behavior.","code":"library(tsExtremes) library(VGAM) #> Loading required package: stats4 #> Loading required package: splines set.seed(123) n       <- 4000 phi     <- 0.5 alpha   <- 1 sample  <- ARm(n,phi, Z.gen = function(n) VGAM::rpareto(n, shape = 1/alpha) ) ## Samples from an Autoregressive model.  extremogram(sample) n       <- 4000 sample  <- VGAM::rpareto(n, shape = 1/alpha) ## Samples from an Autoregressive model.  extremogram(sample)"},{"path":"https://gburitica.github.io/tsExtremes/articles/Cluster-functional-Analysis.html","id":"extremal-index","dir":"Articles","previous_headings":"","what":"Extremal index","title":"Section 2: Cluster inference","text":"extremal index stationary time series motivated findings (Newell, 1964), (Leadbetter, 1983), (Leadbetter et al., 1983), discovered numerous real-valued stationary sequences \\((X_t)\\), \\[ Pr \\left( \\max_{t=1,\\dots,n} |X_t| \\le u_n \\right) \\; \\approx \\; \\Big[ Pr( X_1 \\le u_n) \\Big]^{n \\theta_X} \\; = \\; Pr \\left( \\max_{t=1,\\dots,n} |X^\\prime_t| \\le u_n \\right)^{\\theta_X}, \\quad n \\\\infty, \\] \\((X^\\prime_t)\\) time series iid variables distributed \\(X_1\\), \\(\\theta_{X} \\[0,1]\\), \\(u_n = u_n(\\tau)\\) sequence high thresholds \\(n \\, Pr(X_1 > u_n) \\\\tau\\), previous relation holds every \\(\\tau > 0\\). constant \\(\\theta_{X}\\) exists, say time series admits extremal index given \\(\\theta_X\\). expression , see extremal index measures shrinkage effect blocks maxima compared behaviour iid setting. reason shrinkage extremes records numerous time series tend cluster, high records likely followed period several extreme values. see time dependencies perturb behavior series, consider partition sample \\(m_n = \\lfloor n/b_n \\rfloor\\) disjoint blocks \\[ \\underbrace{X_1,\\dots,X_{b_n}}_{\\mathcal{B}_1},  \\underbrace{X_{b_n+1},\\dots,X_{2 b_n}}_{\\mathcal{B}_2}, \\dots, \\underbrace{X_{m_nb_n - b_n +1},\\dots,X_{m_n b_n}}_{\\mathcal{B}_{m_n}}, \\] Considering maxima block consists keeping largest records discarding rest observations. However, extremes cluster short periods, procedure discard several high recordings. many high records loose , measured extremal index. precisely, extremal index interpretation seen reciprocal number high recordings block.","code":""},{"path":"https://gburitica.github.io/tsExtremes/articles/Cluster-functional-Analysis.html","id":"inference-of-the-extremal-index","dir":"Articles","previous_headings":"Extremal index","what":"Inference of the extremal index","title":"Section 2: Cluster inference","text":"extremal index essential correct inference procedures extreme value statistics initially tailored iid observations. example, can used extrapolate high quantiles sample´s blocks maxima. following, see infer extremal index sample observations. purpose, let \\({\\bf X}_1,\\dots, {\\bf X}_n\\) observations values \\(\\mathbb{R}^d\\) stationary time series \\(({\\bf X}_t)_{t\\\\mathbb{Z}}\\). focus case heavy-tailed series admitting tail-index \\(\\alpha > 0\\). setting, (Buriticá et al., 2021) introduced extremal index cluster estimator given Spectral cluster estimator extremal index: \\[ \\widehat \\theta_{|{\\bf X}|} = \\frac{1}{k_n}   \\sum_{t=1}^{m_n} \\frac{\\|\\mathcal{B}_t\\|^{\\widehat\\alpha}_\\infty}{\\|\\mathcal{B}_t\\|^{\\widehat\\alpha}_{\\widehat\\alpha}}1(\\|\\mathcal{B}_t\\|_{\\widehat\\alpha}\\ge \\|\\mathcal{B}_t\\|_{\\widehat\\alpha,(k)}), \\] \\(\\|\\mathcal{B}_t\\|_{\\widehat\\alpha,(1)} \\ge \\|\\mathcal{B}_t\\|_{\\widehat\\alpha,(2)} \\ge \\cdots \\ge \\|\\mathcal{B}_t\\|_{\\widehat\\alpha,(m_n)}\\) order statistics \\(\\widehat\\alpha-\\)norms blocks, \\(\\widehat \\alpha\\) estimate tail index \\(\\alpha > 0\\). sequence \\((k_n)\\) tuning parameter spectral cluster estimator. must chose small proportion total amount blocks \\(m_n = \\lfloor n/b_n \\rfloor\\), \\(m_n/k_n \\\\infty\\). way, inference based solely extremal blocks.","code":""},{"path":"https://gburitica.github.io/tsExtremes/articles/Cluster-functional-Analysis.html","id":"implementation","dir":"Articles","previous_headings":"","what":"Implementation","title":"Section 2: Cluster inference","text":"start loading \\(\\texttt{tsExtremes}\\) package. implement spectral cluster estimator, first start computing estimate tail-index series. stationary time series short-range dependence, Hill-type estimators still yield good results general. \\(\\texttt{tsExtremes}\\) package also allows sample classical time series models, estimate cluster lengths. following chunk simulates solution stochastic recurrence equation \\[ X_t = A_t X_{t-1} + B_t, \\quad t \\\\mathbb{Z}, \\] \\(\\log A_t \\sim N_t - 0.5\\), \\(B_t ~ Unif(0,1)\\), \\(N_t \\sim \\mathcal{N}(0,1)\\) \\((A_t), (B_t)\\) independent iid sequences. case \\(\\alpha = 1\\) \\(\\theta_X \\approx 0.2792\\). functions piCP computes estimates extremal index, well estimates cluster lengths, function k. Notice method also computes estimates asymptotic variance relying (Buriticá Wintenberger, 2022), use draw confidence intervals. red line corresponds true value.  Similarly, can produce plots option plot=T. dashed line blue gives estimate k = 10.  Finally, recall rainfall data set presented tail index analysis. can now apply method data set.","code":"library(tsExtremes) set.seed(123) path         <- ARCHm(8000) alphae       <- 1/alphaestimator(path,k1=1200)$xi  theta        <- 0.2792 estimate     <-  piCP(path,alphae)  ks           <-  estimate$k estimate     <-  piCP(path,alphae,plot=T) path         <- rainfall$BREST[rainfall$SEASON==\"SPRING\"] alphae       <- 1/alphaestimator(path,k1=150)$xi  estimate     <- piCP(path,alphae,plot=T)"},{"path":[]},{"path":"https://gburitica.github.io/tsExtremes/articles/Example-Analysis.html","id":"main-goals-of-this-tutorial","dir":"Articles","previous_headings":"","what":"Main goals of this tutorial","title":"Section 1: Tail-index inference","text":"Review heavy-tailed random variables. Compute estimates tail index. tail-index \\(\\alpha > 0\\) heavy-tailed random variable \\(X\\) associated magnitude rare events, section review definition heavy-tailed variables. tail-index key statistic risk assessment applications measures magnitude extremes. Roughly speaking, \\(\\alpha\\) small, extremes highly significant, practical perspective, translates high-impact consequences. example, hydrology heavy precipitation amounts lead devastating losses. sum , \\(\\alpha\\) small, extremely high records likely happen \\(\\alpha\\) large.","code":""},{"path":"https://gburitica.github.io/tsExtremes/articles/Example-Analysis.html","id":"heavy-tailed-random-variables","dir":"Articles","previous_headings":"","what":"Heavy-tailed random variables","title":"Section 1: Tail-index inference","text":"setting, consider real-valued random variable \\(X\\) say heavy-tailed tail distribution polynomial decay. fomalize definition introduce concept regular variation. Definition. (Regular variation) say real valued random variable \\(X\\) distribution \\(F\\) regularly varying tail-index \\(\\alpha > 0\\) \\(\\lim_{t \\\\infty}\\bar F(tx)/\\bar F(t) = x^{-\\alpha},\\) \\(\\bar F(t) := 1- F(t)\\) tail distribution.  following call heavy-tailed variables regularly varying distributions. Examples heavy-tailed variables Pareto random variables, Fréchet, \\(t-\\)student, Burr log Gamma distribution. Examples light-tailed distributions include exponential, Weibull gaussian distribution. light-tailed examples, tail distributions decay exponential rate polynomial rate regularly varying distribution. practice means rare record high levels sampling , instead values concentrate around mean.","code":""},{"path":"https://gburitica.github.io/tsExtremes/articles/Example-Analysis.html","id":"moments-of-regularly-varying-distributions","dir":"Articles","previous_headings":"Heavy-tailed random variables","what":"Moments of regularly varying distributions","title":"Section 1: Tail-index inference","text":"case regularly varying random variables, variance mean can sometimes equal infinity. means sampling variable, obtain highly scattered observations reaching higher records comparison light-tailed distributions. see consider following samples, respective boxplot.  already mentioned, tail index heavy-tailed random variable plays important role determining heaviness tails. Moments’ property:  \\(X\\) non-negative regularly varying index \\(\\alpha > 0\\), \\(p > \\alpha\\), \\(E[X^p] = + \\infty\\), \\(p < \\alpha\\), \\(E[X^p] < + \\infty\\). particular moments’ property entails \\(\\alpha \\(0,2)\\), variance variable \\(X\\) infinite \\(\\alpha \\(0,1)\\) mean infinite. words, small values \\(\\alpha\\) indicate heavier tails larger values \\(\\alpha\\). reasons, estimating tail-index random variable \\(X\\) important quantify magnitude rare events. full overview regularly varying distributions refer (Bingham, Goldie, Teugels 1987).","code":"library(VGAM) library(ggplot2) set.seed(123) n     <- 500 alpha <- 2 sample_exponential <- 1 + rexp(n) sample_pareto      <- VGAM::rpareto(n, shape=alpha)"},{"path":"https://gburitica.github.io/tsExtremes/articles/Example-Analysis.html","id":"inference-of-the-tail-index","dir":"Articles","previous_headings":"","what":"Inference of the tail-index","title":"Section 1: Tail-index inference","text":"subsection now turn problem esimating tail-index data. consider sample observations \\(X_1, \\dots, X_n\\) distribution \\(X\\), necessarily independent.","code":""},{"path":"https://gburitica.github.io/tsExtremes/articles/Example-Analysis.html","id":"motivation","dir":"Articles","previous_headings":"Inference of the tail-index","what":"Motivation","title":"Section 1: Tail-index inference","text":"motivate Hill estimator, note \\(P\\) follows Pareto distribution tail index \\(\\alpha\\), \\(\\mathbb{P}(Y > x) = 1 -x^{-\\alpha}\\), straightforward calculations imply \\[E[\\log(P)] = \\frac{1}{\\alpha}.\\] generality, \\(X\\) regularly varying, \\(x > 1\\), \\[ \\lim_{t \\\\infty}\\mathbb{P}(X/t > x \\mid X > t) = \\lim_{t \\\\infty} {\\overline F(tx)}/{\\overline F(t) } = x^{-\\alpha}. \\] last equality follows definition regularly varying random variables. can interpret equation say renormalized sample exceeded amount follows asymptotically Pareto distribution. sense \\[\\mathbb{E}[ \\log(X/t) | X > t] \\approx \\frac{1}{\\alpha}, \\qquad t \\\\infty. \\] Finally, replacing right-hand side previous relation empirical counterpart yields \\[ \\frac{ \\sum_{j=1}^n \\log(X_j/t)1(X_j > t)}{\\sum_{j=1}^n 1(X_j> t)} \\approx \\frac{1}{\\alpha}, \\qquad t \\\\infty. \\] value \\(t\\) high threshold sample. case, replace \\(t\\) order statistic sample. \\(X_{(1)} \\geq X_{(2)} \\geq \\cdots \\geq X_{(n)}\\) sorted sample values, see letting \\(t = X_{(k^\\prime+1)}\\) previous expression obtain Hill estimator Hill estimator. Hill estimator general procedure estimate tail-index \\(X\\), given \\[ \\frac{1}{\\widehat{\\alpha}^n} \\;  := \\;  \\frac{1}{\\widehat{\\alpha}^n(k^\\prime)}  := \\frac{1}{k^\\prime} \\, \\sum_{t=1}^{n} \\log(X_t/X_{(k^\\prime+1)})1(X_t > X_{(k^\\prime +1)}), \\] \\(X_{(1)} \\geq X_{(2)} \\geq \\dots \\geq  X_{(n)}\\) sorted sample records, \\(k^\\prime\\) tuning parameter Hill estimator.  see previous expression assumption regular variation means top records sample: \\(X_{(1)} \\geq \\cdots \\geq X_{(k^\\prime)}\\), resemble sample Pareto distribution tail-index \\(\\alpha > 0\\). Finally, Hill estimator yields consistent estimates tail-index \\(X\\) even temporal dependence strong, think example stationary AR(1) series: \\(X_t = \\rho X_{t-1} + Z_{t}\\), \\(|\\rho| < 1\\), \\((\\mathbb{Z})\\) series iid regularly varying innovations. refer Chapter 4 (Beirlant et al. 2004) detailed treatment tail-index inference.","code":""},{"path":"https://gburitica.github.io/tsExtremes/articles/Example-Analysis.html","id":"bias-variance-trade-off","dir":"Articles","previous_headings":"Inference of the tail-index","what":"Bias-Variance trade-off","title":"Section 1: Tail-index inference","text":"Hill estimator requires tuning parameter \\(k^\\prime\\) implementation, choice highlights classical bias-variance trade-extreme value statistics. Larger values \\(k^\\prime\\) mean average larger number sample records compute Hill estimate, typically translates variance reduction statistical procedure. Nevertheless, obtain unbiased estimates tail-index important top records: \\(X_{(1)} \\geq \\cdots \\geq X_{(k^\\prime)}\\) nicely resemble sample Pareto distribution tail-index \\(\\alpha\\). However, generality granted many cases \\(k^\\prime = k_n^\\prime\\) rather small compared \\(n\\), means can focus top records. qq-plot : illustrate bias-variance trade-, let’s take \\(P\\) Pareto distribution. Moreover notice \\(p \\(0,1)\\), quantiles \\(\\log P\\) can computed noticing \\(\\mathbb{P}(\\log(P) >  - \\log(p)/\\alpha ) = \\mathbb{P}(P > p^{-1/\\alpha} ) = p.\\) equation demonstrates qq-plot sample \\(\\log(P)\\) given points \\[ (\\log(P_{(k)}),-\\log(1-k/n)/\\alpha),\\] recall notation \\(P_{(1)} \\geq \\cdots P_{(n)}\\). Instead, general regularly varying variables \\(X\\), plot \\((\\log(X_{(k)}),-\\log(1-k/n)/\\alpha))\\), highest records sample align quantiles \\(\\log P\\).  Finally, expected can see plot \\(X\\) follows Fréchet distributions, \\(k^\\prime\\)-largest sample records can accurately modeled using Pareto distribution. plot take case need choose \\(k^\\prime = k_n^\\prime\\) Hill estimator rather small compared \\(n\\) satisfactorily describe tail properties variable \\(X\\).","code":"library(ggpubr) sample_frechet     <- rfrechet(n, shape = alpha) sample_pareto      <- VGAM::rpareto(n, shape=alpha) df <- data.frame('log_frechet' = log(sort(sample_frechet)),                    'log_pareto' = log(sort(sample_pareto))) g1 <- ggplot(df) + geom_point(aes( y = -log(1-1:n/n)/alpha, x = log_pareto )) + geom_abline(slope=1) g2 <- ggplot(df) + geom_point(aes( y = -log(1-1:n/n)/alpha, x = log_frechet )) + geom_abline(slope=1) ggarrange(g1,g2)"},{"path":[]},{"path":"https://gburitica.github.io/tsExtremes/articles/Example-Analysis.html","id":"hill-estimator","dir":"Articles","previous_headings":"tsExtremes package implementation","what":"Hill estimator","title":"Section 1: Tail-index inference","text":"now ready use tsExtremes package compute Hill estimates tail-index. start loading \\(\\texttt{tsExtremes}\\) package.  see Fréchet sample important choose tuning parameter relatively small obtain nice estimates tail-index.","code":"library(tsExtremes) h <- hillestimator(sample_pareto, plot=T , k1=1:500 ) abline(h=1/alpha) h <- hillestimator(sample_frechet, plot=T , k1=1:500 ) abline(h=1/alpha)"},{"path":"https://gburitica.github.io/tsExtremes/articles/Example-Analysis.html","id":"unbiased-hill-estimator","dir":"Articles","previous_headings":"tsExtremes package implementation","what":"Unbiased Hill estimator","title":"Section 1: Tail-index inference","text":"mentioned, choice \\(k^\\prime\\) key obtain unbiased estimates tail-index. choose \\(k^\\prime\\) one idea previous plot, -called Hill plot, pick value range estimated values steady function \\(k^\\prime\\). However, often practice clear find steady region estimator unstable function \\(k^\\prime\\). (Haan, Mercadier, Zhou 2016) propose bias-correction methodology Hill-estimator allows obtain Hill-based estimates robust choice tuning parameter. compare estimator following case study precipitation amounts. \\(\\texttt{tsExtremes}\\) package includes rainfall dataset, containing daily rainfall records nine different weather stations France. data season record available. compute tail-index produce Hill Plot summer rainfall Brest use function .  see fro plot Hill estimator clear choose tuning parameter. Instead, unbiased-Hill procedure stable wider range values facilitates chooing \\(k^\\prime\\).","code":"h <- alphaestimator(rainfall$BREST[rainfall$SEASON==\"SPRING\"], plot=T , R0 = 100,  hill=T ,  k1 = 300 )"},{"path":[]},{"path":"https://gburitica.github.io/tsExtremes/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gloria Buriticá. Author, maintainer.","code":""},{"path":"https://gburitica.github.io/tsExtremes/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Buriticá G (2024). tsExtremes: Time Series Analysis Extremes. R package version 0.0.0.1,  https://gburitica.github.io/tsExtremes/, https://github.com/GBuritica/tsExtremes.","code":"@Manual{,   title = {tsExtremes: Time Series Analysis of Extremes},   author = {Gloria Buriticá},   year = {2024},   note = {R package version 0.0.0.1,  https://gburitica.github.io/tsExtremes/},   url = {https://github.com/GBuritica/tsExtremes}, }"},{"path":"https://gburitica.github.io/tsExtremes/index.html","id":"tsextremes-package-tutorial","dir":"","previous_headings":"","what":"Time Series Analysis of Extremes","title":"Time Series Analysis of Extremes","text":"package tsExtremes includes functions studying extreme features heavy-tailed time series. can used compute estimates tail index, extremal index cluster lengths series. statistics series summarizing magnitude extreme records, number concomitant records.","code":""},{"path":"https://gburitica.github.io/tsExtremes/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Time Series Analysis of Extremes","text":"get started, install package Github using command:","code":"devtools::install_github('GBuritica/tsExtremes')"},{"path":"https://gburitica.github.io/tsExtremes/index.html","id":"r-package-tutorial","dir":"","previous_headings":"","what":"R Package tutorial","title":"Time Series Analysis of Extremes","text":"package tutorial includes two main windows : vignette learn compute estimates tail index α series. implementation based Hill-type estimators (Haan, Mercadier, Zhou 2016). vignette learn implement block estimates cluster statistics; see (Buriticá, Mikosch, Wintenberger 2022). consider example extremal index based estimator proposed (Buriticá et al. 2021), also example cluster lengths (Buriticá Wintenberger 2024).","code":""},{"path":[]},{"path":"https://gburitica.github.io/tsExtremes/reference/ARCH2m.html","id":null,"dir":"Reference","previous_headings":"","what":"ARCH2m — ARCH2m","title":"ARCH2m — ARCH2m","text":"Function sample model X= AX + B     X = (eta + lambda X) Z^2, Z iid Gaussian. default values, model index regular variation alpha = 1 extremal index theta = 0.727","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/ARCH2m.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ARCH2m — ARCH2m","text":"","code":"ARCH2m(   n0,   eta = 2 * 10^{      -5  },   lambda = 0.5 )"},{"path":"https://gburitica.github.io/tsExtremes/reference/ARCH2m.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ARCH2m — ARCH2m","text":"n0 (Integer trajectory length) eta (Real value) lambda (Real value)","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/ARCH2m.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ARCH2m — ARCH2m","text":"(Vector length n0 sampled SRE model)","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/ARCH2m.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ARCH2m — ARCH2m","text":"","code":"path <- ARCH2m(1000) plot.ts(path)"},{"path":"https://gburitica.github.io/tsExtremes/reference/ARCHm.html","id":null,"dir":"Reference","previous_headings":"","what":"ARCHm — ARCHm","title":"ARCHm — ARCHm","text":"Function sample model X  = AX + B     log ~ N-0.5, B ~ Unif(0,1) model index regular variation alpha = 1 extremal index theta = 0.2792","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/ARCHm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ARCHm — ARCHm","text":"","code":"ARCHm(n0)"},{"path":"https://gburitica.github.io/tsExtremes/reference/ARCHm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ARCHm — ARCHm","text":"n0 (Integer trajectory length)","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/ARCHm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ARCHm — ARCHm","text":"(Vector length n0 sampled SRE model)","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/ARCHm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ARCHm — ARCHm","text":"","code":"path <- ARCHm(1000) plot.ts(path)"},{"path":"https://gburitica.github.io/tsExtremes/reference/ARm.html","id":null,"dir":"Reference","previous_headings":"","what":"AR model — ARm","title":"AR model — ARm","text":"Function sample model X = (par0)X + Z. default values, model index regular variation alpha identical Z extremal index 1-(par0)^alpha","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/ARm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"AR model — ARm","text":"","code":"ARm(n0, par0 = 0.7, Z.gen = function(n) rt(n, df = 1))"},{"path":"https://gburitica.github.io/tsExtremes/reference/ARm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"AR model — ARm","text":"n0 (Integer trajectory length) par0 (Value (0,1)) Z.gen (Function trajectory length n sample noise)","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/ARm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"AR model — ARm","text":"(Vector length n0 sampled SRE model)","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/ARm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"AR model — ARm","text":"","code":"path  <- ARm(1000,0.7) plot.ts(path)"},{"path":"https://gburitica.github.io/tsExtremes/reference/alphaestimator.html","id":null,"dir":"Reference","previous_headings":"","what":"alphaestimator — alphaestimator","title":"alphaestimator — alphaestimator","text":"function computes (tail)-index function k returns unbiased Hill estimator de Haan et al. tuning parameter rho = 2","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/alphaestimator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"alphaestimator — alphaestimator","text":"","code":"alphaestimator(   sample,   k1 = floor(n^(0.7)),   plot = FALSE,   R0 = 100,   hill = FALSE,   ylim0 = NULL )"},{"path":"https://gburitica.github.io/tsExtremes/reference/alphaestimator.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"alphaestimator — alphaestimator","text":"sample (Vector nonnegative univariate entries) k1 (Integer indicating number high order statistics consider inference) plot (T F indicate plot Hill estimates function k must shown) R0 (Integer number bootstrap replicates consider computing confidence intervals) hill (T F indicate classical Hill-plot also plotted) ylim0 (Vector lower upper bounds y-axis plot )","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/alphaestimator.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"alphaestimator — alphaestimator","text":"data.frame xi estimate confidence intervals lower upper bounds.","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/alphaestimator.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"alphaestimator — alphaestimator","text":"","code":"sample   <- abs( arima.sim(n = 8000, list(ar=0.5, ma=0), rand.gen=function(n) rt(n,df=4) ) ) h <- alphaestimator(sample, plot=TRUE , R0 = 100,  hill=TRUE,   k1 = 1000 )  h <- alphaestimator(sample, plot=TRUE , R0 = 100,  hill=FALSE,  k1 = 1000 ) abline(h=0.25,col = \"red\")"},{"path":"https://gburitica.github.io/tsExtremes/reference/alphaestimator2.html","id":null,"dir":"Reference","previous_headings":"","what":"alphaestimator2 — alphaestimator2","title":"alphaestimator2 — alphaestimator2","text":"function computes (tail)-index. returns mean estimate Pickands, Hill DeHaan estimators 96th empirical quantile. uses fExtreme code.","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/alphaestimator2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"alphaestimator2 — alphaestimator2","text":"","code":"alphaestimator2(path0)"},{"path":"https://gburitica.github.io/tsExtremes/reference/alphaestimator2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"alphaestimator2 — alphaestimator2","text":"path0 (Vector univariate observations)","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/alphaestimator2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"alphaestimator2 — alphaestimator2","text":"integer tail - index estimate","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/alphaestimator2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"alphaestimator2 — alphaestimator2","text":"","code":"sample   <- abs( arima.sim(n = 8000, list(ar=0.5, ma=0), rand.gen=function(n) rt(n,df=4) ) ) h  <- alphaestimator2(sample)"},{"path":"https://gburitica.github.io/tsExtremes/reference/eiCP.html","id":null,"dir":"Reference","previous_headings":"","what":"eiCP — eiCP","title":"eiCP — eiCP","text":"Estimates extremal index based alpha cluster Process","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/eiCP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"eiCP — eiCP","text":"","code":"eiCP(path0, alpha0, klim0 = 100, n0 = length(path0), plot = F)"},{"path":"https://gburitica.github.io/tsExtremes/reference/eiCP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"eiCP — eiCP","text":"path0 (Matrix sample trajectory time series) alpha0 (Integer estimate tail index) klim0 (Integer largest order statistic k consider, vector values k consider) n0 (Integer path length) plot (F T plot estimates function k must shown)","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/eiCP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"eiCP — eiCP","text":"data frame estimates extremal index values k block lengths b used inference estimate asymptotic variance also provided using cluster process inference.","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/eiCP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"eiCP — eiCP","text":"","code":"path  <- ARCHm(20000) alpha <- 1/alphaestimator(path,k1=1200)$xi ## The real value should be one ei    <- eiCP(path,alpha,plot=T)  pi    <- piCP(path,alpha,plot=T)"},{"path":"https://gburitica.github.io/tsExtremes/reference/ext.html","id":null,"dir":"Reference","previous_headings":"","what":"Extremogram auxiliar function — ext","title":"Extremogram auxiliar function — ext","text":"Extremogram auxiliar function","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/ext.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extremogram auxiliar function — ext","text":"","code":"ext(sample, maxlag = 10, q)"},{"path":"https://gburitica.github.io/tsExtremes/reference/ext.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extremogram auxiliar function — ext","text":"sample vector maxlag integer q quantile value $(0,1)$","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/ext.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extremogram auxiliar function — ext","text":"vector extremogram output","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/extremogram.html","id":null,"dir":"Reference","previous_headings":"","what":"Empirical temporal extremogram — extremogram","title":"Empirical temporal extremogram — extremogram","text":"Empirical temporal extremogram","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/extremogram.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Empirical temporal extremogram — extremogram","text":"","code":"extremogram(sample, maxlag = 45, q = 0.95, plot = T)"},{"path":"https://gburitica.github.io/tsExtremes/reference/extremogram.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Empirical temporal extremogram — extremogram","text":"sample numerical vector compute extremogram maxlag integer q quantile level (0,1). plot logical value plot results","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/extremogram.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Empirical temporal extremogram — extremogram","text":"vector extremogram values","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/extremogram.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Empirical temporal extremogram — extremogram","text":"temporal extremogram \\(\\chi_t\\) defined $$\\chi_t = \\lim_{t \\\\infty} \\mathbb{P}( X_t > x | X_0 > x).$$ empirical version, computes average number exceedances q-th order statistic. baseline, extremogram takes value 1-q independent lags.","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/extremogram.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Empirical temporal extremogram — extremogram","text":"","code":"pre    <- tsExtremes::rainfall ## load rainfall data sample <- na.omit(sample)      ## removes columns with missing values sample <- tsExtremes::rmax(pre[pre$SEASON=='FALL' , 5:7]) ## computes vector-wise maxima tsExtremes::extremogram(sample) #> Error in tsExtremes::extremogram(sample): object 'n' not found"},{"path":"https://gburitica.github.io/tsExtremes/reference/functionalCP.html","id":null,"dir":"Reference","previous_headings":"","what":"functionalCP — functionalCP","title":"functionalCP — functionalCP","text":"Estimates cluster statistics based alpha cluster Process","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/functionalCP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"functionalCP — functionalCP","text":"","code":"functionalCP(   path0,   alpha0,   klim0 = 100,   n0 = length(path0),   p0 = \"alpha\",   cluster_func = function(block) max(abs(block)^alpha0),   plot = F )"},{"path":"https://gburitica.github.io/tsExtremes/reference/functionalCP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"functionalCP — functionalCP","text":"path0 (Matrix sample trajectory time series) alpha0 (Integer estimate tail index) klim0 (Integer largest order statistic k consider, vector values k consider) n0 (Integer path length) cluster_func (function evaluate extremal blocks. default provide functional computing extremal index) plot (F T plot estimates function k must shown)","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/functionalCP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"functionalCP — functionalCP","text":"data frame estimates cluster functional estimates values k block lengths b used inference estimate asymptotic variance also provided using cluster process inference.","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/functionalCP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"functionalCP — functionalCP","text":"","code":"path  <- ARCHm(20000) alpha <- 1/alphaestimator(path,k1=1200)$xi ## The real value should be one ei    <- functionalCP(path,1,plot=T)       ## two options are available for computing the extremal index #> Error in cluster_func(path0[((l - 1) * b0 + 1):(l * b0)]/suma_p[l], p0,     alpha0): unused arguments (p0, alpha0) ei2   <- eiCP(path,1,plot=T)"},{"path":"https://gburitica.github.io/tsExtremes/reference/hillestimator.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute (tail)-index — hillestimator","title":"Compute (tail)-index — hillestimator","text":"function computes Hill (tail)-index estimate stationary time series.","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/hillestimator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute (tail)-index — hillestimator","text":"","code":"hillestimator(path, k1 = NULL, plot = F)"},{"path":"https://gburitica.github.io/tsExtremes/reference/hillestimator.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute (tail)-index — hillestimator","text":"path (vector univariate observations) k1 (vector order statistics compute Hill estimates). uses k1 = n*0.05 otherwise plot (T F plot shown).","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/hillestimator.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute (tail)-index — hillestimator","text":"data.frame hill estimates function k.","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/hillestimator.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute (tail)-index — hillestimator","text":"","code":"h <- hillestimator(rainfall$LANVEOC[rainfall$SEASON=='SPRING'], 1:200) h <- hillestimator(rainfall$LANVEOC[rainfall$SEASON=='SPRING'], plot=T)"},{"path":"https://gburitica.github.io/tsExtremes/reference/piCP.html","id":null,"dir":"Reference","previous_headings":"","what":"piCP — piCP","title":"piCP — piCP","text":"Estimates cluster legths extrema index based alpha cluster Process","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/piCP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"piCP — piCP","text":"","code":"piCP(path0, alpha0, klim0 = 100, n0 = length(path0), plot = F)"},{"path":"https://gburitica.github.io/tsExtremes/reference/piCP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"piCP — piCP","text":"path0 (Matrix sample trajectory time series) alpha0 (Integer estimate tail index) klim0 (Integer largest order statistic k consider, vector values k consider) n0 (Integer path length) plot (F T plot estimates function k must shown)","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/piCP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"piCP — piCP","text":"data frame estimates cluster lengths pi_j values k block lengths b used inference estimate asymptotic variance also provided using cluster process inference.","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/piCP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"piCP — piCP","text":"","code":"path  <- ARCHm(20000) alpha <- 1/alphaestimator(path,k1=1200)$xi ## The real value should be one pi    <- piCP(path,alpha,plot=T)"},{"path":"https://gburitica.github.io/tsExtremes/reference/rainfall.html","id":null,"dir":"Reference","previous_headings":"","what":"Daily rainfall data set from a network of weather stations in France — rainfall","title":"Daily rainfall data set from a network of weather stations in France — rainfall","text":"data set precipitation amounts mm nine weather stations.","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/rainfall.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Daily rainfall data set from a network of weather stations in France — rainfall","text":"","code":"rainfall"},{"path":"https://gburitica.github.io/tsExtremes/reference/rainfall.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Daily rainfall data set from a network of weather stations in France — rainfall","text":"data frame 10 columns. y.date Date BREST Precipitation amounts Brest (oceanic weather) LANVEOC Precipitation amounts Lanveoc (oceanic weather) QUIMPER Precipitation amounts Quimper (oceanic weather) BORMES Precipitation amounts Bormes (mediterranean weather) LE.LUC Precipitation amounts Le Luc (mediterranean weather) HYERES Precipitation amounts Hyeres (mediterranean weather) NANCY Precipitation amounts Nancy (continental weather) METZ Precipitation amounts Metz (continental weather) ROVILLE Precipitation amounts Roville (continental weather) SEASON Season","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/rainfall.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Daily rainfall data set from a network of weather stations in France — rainfall","text":"Méteo France.","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/rmax.html","id":null,"dir":"Reference","previous_headings":"","what":"Row maxima — rmax","title":"Row maxima — rmax","text":"rmax() computes maxima row-wise","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/rmax.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Row maxima — rmax","text":"","code":"rmax(mat)"},{"path":"https://gburitica.github.io/tsExtremes/reference/rmax.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Row maxima — rmax","text":"mat Matrix","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/rmax.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Row maxima — rmax","text":"numerical vector number columns mat","code":""},{"path":"https://gburitica.github.io/tsExtremes/reference/rmax.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Row maxima — rmax","text":"","code":"x <- rbind( c(1,2), c(1,1) ) rmax(x) #> [1] 2 1"}]
